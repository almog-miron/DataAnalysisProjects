SQL Queries:

Q1 – Revenue by Year & Hotel

WITH hotels AS (
  SELECT * FROM dbo.[2018$]
  UNION SELECT * FROM dbo.[2019$]
  UNION SELECT * FROM dbo.[2020$]
)
SELECT arrival_date_year, 
       hotel,
       ROUND(SUM((stays_in_week_nights + stays_in_weekend_nights) * adr), 2) AS revenue
FROM hotels
GROUP BY arrival_date_year, hotel;



Q2 – Parking Space Usage

SELECT arrival_date_year, 
       hotel,
       SUM(required_car_parking_spaces) AS total_cars,
       SUM(stays_in_weekend_nights + stays_in_week_nights) AS total_nights,
       ROUND(
         CAST(SUM(required_car_parking_spaces) AS FLOAT) / NULLIF(SUM(stays_in_weekend_nights + stays_in_week_nights), 0) * 100, 
         2
       ) AS car_percentage
FROM (
  SELECT * FROM ['2018$']
  UNION 
  SELECT * FROM ['2019$']
  UNION 
  SELECT * FROM ['2020$']
) AS hotels
GROUP BY arrival_date_year, hotel;



Q3 - Additional Query

WITH hotels AS (
SELECT * FROM dbo.['2018$']
UNION
SELECT * FROM dbo.['2019$']
UNION
SELECT * FROM dbo.['2020$'])

SELECT * FROM hotels
LEFT JOIN dbo.market_segment$
ON hotels.market_segment = market_segment$.market_segment
LEFT JOIN dbo.meal_cost$
ON meal_cost$.meal = hotels.meal
